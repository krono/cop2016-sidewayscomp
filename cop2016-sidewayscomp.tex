%
%  Fast Sideways Composition, for COP 2016
%
% Confirmation Number:» 
% Submission Passcode:» 
% MAX 6 PAGES
%
\RequirePackage[l2tabu, orthodox]{nag}
\PassOptionsToPackage{final}{graphics}
\documentclass[preprint,english,10pt,nonatbib]{sigplanconf}
\usepackage{myheader}
\addbibresource{references.bib}
\begin{document}
\conferenceinfo{COP '16}{July 19, 2016, Rome, Italy}
\copyrightyear{2016}
\copyrightdata{978-1-nnnn-nnnn-n/16/07}
\copyrightdoi{nnnnnnn.nnnnnnn}

\publicationrights{licensed}     % this is the default

\titlebanner{DRAFT \--- not for distribution \--- DRAFT}        % These are ignored unless
\preprintfooter{Submitted to COP'16}

\title{Optimizing Sideways Composition}
\subtitle{Fast Context-oriented Programming in ContextPyPy}

\authorinfo{Tobias Pape}
           {Hasso Plattner Institute\\ University of Potsdam, Germany}
           {tobias.pape@hpi.uni-potsdam.de}
\authorinfo{Tim Felgentreff}
           {Hasso Plattner Institute\\ University of Potsdam, Germany}
           {tim.felgentreff@hpi.uni-potsdam.de}
% \authorinfo{Carl Friedrich Bolz}
%            {King's College, London}
%            {cfbolz@gmx.de}
\authorinfo{Robert Hirschfeld}
           {Hasso Plattner Institute\\ University of Potsdam, Germany}
           {hirschfeld@hpi.uni-potsdam.de}

\maketitle

\begin{abstract}
  \begin{itemize}
  \item Typical object systems only support static, single inheritance, both
    are limiting.
  \item Sideways composition provides a way of reducing their limitations.
  \item COP notably applies SC for good modularity.
  \item Most COP implementations have a substantial performance overhead.
  \item This is because weaving and execution of layered methods violate common
    assumptions about lookup.
  \item Meta-tracing JITs have unique characteristics that can alleviate the
    performance overhead.
  \item They don't need to make as strong assumptions as traditional execution
    environments have to.
  \item We postulate that MT-JITs are good at optimizing sideways composition
    and give initial results.
  \item We show that hints for the JIT compiler in the COP implementation can
    improve performance further.
  \end{itemize}
\end{abstract}

\category{CR-number}{subcategory}{third-level}

\keywords
keyword1, keyword2

\section{Introduction}

\paragraph*{Contributions}

\begin{itemize}
\item <<We show that metatracing not only makes python fast, but also COP/SC
  faster>>
\item <<We show that \emph{promote}(TBD) can further improve stuff and
  elimitates COP overhead when COP Layers are present but not in use>>
\end{itemize}

\section{<<Background: COP, COPSurvey, MetaTracing>>}
\section{<<Solution: Sideways-composition and metatracing>>}
\section{<<Impl: ContextPy, VM interface, applevel promote>>}
\section{<<Eval: Benchmarks>>}


\def\idBox#1#2{%
\setlength{\fboxsep}{1pt}%
\colorbox[HTML]{#1}{\textcolor[gray]{0.9}{\rule[0.1pt]{0pt}{5pt}#2}}%
\xspace}



We evaluate... hypotheses..., as described in the introduction:
\begin{enumerate}
\item Sideways composition \emph{still} has a considerable impact on execution
  time. <<still<-> copsurvey>>
\item Tracing JITs can alleviate the performance impact of sideways composition.
\item <<applevel promote>>.
\end{enumerate}



We tested the first hypothesis by ....

We tested the second hypothesis by ....

We tested the third hypothesis by ....

% PYCKET-COPY - DO NOT USE VERBATIM
% Our evaluation compares \pycket with multiple configurations and systems on
% a variety of programs. We present the most important results and include full
% results in supplemental material.

\subsection{Setup}
\label{sec:setup}


\paragraph{System} We conducted the experiments on %
% MacBook Pro Tobi
an Intel Core i7-4850HQ at \SI{2.3}{\GHz} with \SI{6}{\mega\byte} cache and
\SI{16}{\giga\byte} of RAM. The machine ran Mac OS\,X 10.9.5.
%%%% Surface Tim??
%
%%%% Maxinchen
% an Intel Xeon E5-2650 (Sandy Bridge)  at \SI{2.8}{\GHz} with
% \SI{20}{\mega\byte} cache and \SI{16}{\giga\byte} of RAM. 
% Although virtualized on Xen, the machine was idle.
% The machine ran Ubuntu 14.04.1 LTS with a \SI{64}{\bit} Linux 3.2.0.
RPython as of revision
648874ef8243
 was used for <<pypypromote>>.

All benchmarks are single-threaded.


\paragraph{Implementations} %
~\idBox{377EB8}{\(\circ\)}, %
~\idBox{4DAF4A}{\(\bigtriangleup\)}, %
~\idBox{984EA3}{\(\square\)}, %
~\idBox{FF7F00}{\(+\)}, %
~\idBox{FF7F00}{\(\boxtimes\)}, %
~\idBox{E41A1C}{\(\)}, %

<<DeltaBlue/Violet/Red>>
\begin{itemize}
\item ContextPy with Python 2.7.5 on OS\,X
\item ContextPy with PyPy 5.0.1 on OS\,X
\item ContextPy with PyPyPromote (5.1.0-alpha0 648874ef8243) on OS\,X
\end{itemize}

and additionally for <<maltebench>>
\begin{itemize}
\item ContextJS with Chrome 50.0.2661.66 beta (64-bit) on OS\,X
\item << ContextJS Win10 Edge -- tim? >>
\item <<ContextJS Win10 Chrome -- tim?>>
\item <<(ContextJS Win10 Firefox -- tim?)>>
\end{itemize}

\paragraph{Methodology} 
% INITSIZE = 200000
% MAXSIZE = 1000000000
% TARGETTIME = 5.0 * 1000
For <<maltebench>>, every benchmark was with increasing size until a
measurement took at least 5 seconds; this matches the original
methodology~\cite{appeltauer+:2009:comparison-context-oriented}.Warm-up is
provided by the not measured runs.
% ITER_DEFAULT=${ITER:-5}
% SIZE_DEFAULT=${SITE:-20000}
% WARM_DEFAULT=${WARM:-2}
For <<DeltaBlue>>, every benchmark was run 5 times uninterrupted at highest
priority in a new process with additional 2 times prior to measurement.
The execution time was always measured \emph{in-system} and, hence, does not include start-up.
We show the arithmetic mean of all  runs along with
bootstrapped~\cite{davison+:1997:confidence-intervals} confidence intervals
for a \SI{95}{\percent} confidence level.

%\footnote{Raw figures can be  found as an appendix (\autoref{tab:all})}

\paragraph{Availability}  All of our benchmarks and infrastructure
 are available at <<TBD>>.


\subsection{Benchmarks}


\subsection{Threats to Validity}

OSX: SpeedStep cannot be disabled.

\section{Related Work}

\section{<<Conclusion/FW: Promising first results, application to other stuff necessary>>}

\acks
We gratefully acknowledge the financial support of HPI's Research School and
the Hasso Plattner Design Thinking Research Program (HPDTRP).
% Carl Friedrich
% Bolz is supported by the EPSRC \emph{Cooler} grant EP/K01790X/1.

\printbibliography

% \appendix
% \section{Appendix Title}

\end{document}
